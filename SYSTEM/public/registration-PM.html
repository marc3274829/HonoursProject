<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
    background:rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index:1000;">
    <div style="background:#fff; padding:20px 30px; border-radius:8px; text-align:center; min-width:250px;">
        <p id="modalMessage"></p>
        <div id="modalButtons" style="margin-top:15px;">
        </div>
    </div>
</div>
<div class="formBox">
    <h2>Register Account</h2>

    <form id="registerForm">
        <div class="formInput">
            <p>Username</p>
            <input type="text" id="regUsername" required>
            <p>Password</p>
            <input type="password" id="regPassword" required>
            <p>Repeat Password</p>
            <input type="password" id="regRepeatPassword" required>
        </div>
        <div class="button">
             <button class="submit" type="submit" id="sButton">Submit</button>
        </div>
    </form>
</div>


</body>
<script>
const form = document.getElementById('registerForm');
const modal = document.getElementById('modal');
const modalMessage = document.getElementById('modalMessage');
const modalButtons = document.getElementById('modalButtons');

form.addEventListener('submit', (e) => {
    e.preventDefault();

    const username = document.getElementById('regUsername').value;
    const password = document.getElementById('regPassword').value;
    const repeatPassword = document.getElementById('regRepeatPassword').value;

    if(password !== repeatPassword){
        showModal("Passwords do not match!", ["OK"], [() => hideModal()]);
        return;
    }

    showModal("Do you want to save your credentials in the password manager?", 
              ["Yes", "No"], 
              [
                () => { 
                    localStorage.setItem('pmUsername', username);
                    localStorage.setItem('pmPassword', password);
                    showRegistrationSuccess();
                },
                () => { 
                    showRegistrationSuccess();
                }
              ]);
});

function showRegistrationSuccess(){
    showModal("Registration Successful", ["OK"], [() => {
        hideModal();
        form.reset();
        window.location.href = "login-PM.html"; 
    }]);
}

function showModal(message, buttonLabels, callbacks){
    modalMessage.textContent = message;
    modalButtons.innerHTML = ""; 

    buttonLabels.forEach((label, index) => {
        const btn = document.createElement('button');
        btn.textContent = label;
        btn.style.margin = "0 5px";
        btn.onclick = callbacks[index];
        modalButtons.appendChild(btn);
    });

    modal.style.display = "flex";
}

function hideModal(){
    modal.style.display = "none";
}
</script>
</html>